{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MapApp bundle configuration",
  "type": "object",
  "required": ["id", "title", "networkRenderer", "geoRenderer"],
  "properties": {
    "id": { "type": "string", "description": "Bundle id (used for filenames)" },
    "title": { "type": "string", "description": "Human-friendly title" },
    "topogramId": { "type": "string", "description": "Topogram id to export" },
    "networkRenderer": { "type": "string", "enum": ["cytoscape", "sigma", "reagraph"], "description": "Which network renderer to include" },
    "geoRenderer": { "type": "string", "enum": ["maplibre", "leaflet", "cesium"], "description": "Which geo renderer to include" },
    "presentation": {
      "type": "object",
      "properties": {
        "showLegend": { "type": "boolean" },
        "initialLayout": { "type": "string", "description": "Default layout for the network renderer (eg. cose, force, grid)" },
        "mapCenter": { "type": "array", "items": { "type": "number" }, "minItems": 2, "maxItems": 3 },
        "hasTimeline": { "type": "boolean", "description": "Whether to include the timeline panel" },
        "timeline": {
          "type": "object",
          "properties": {
            "autoPlay": { "type": "boolean" },
            "playSpeed": { "type": "number", "minimum": 0 },
            "start": { "type": ["string","number"], "description": "Optional timeline start (ISO date or numeric)" },
            "end": { "type": ["string","number"], "description": "Optional timeline end (ISO date or numeric)" }
          }
        }
      }
    },
    "emojiSupport": { "type": "boolean", "description": "Enable emoji extraction and display in labels" },
    "labeling": {
      "type": "object",
      "properties": {
        "nodeLabelMode": { "type": "string", "enum": ["name","emoji","both"], "description": "How node labels are displayed" },
        "edgeLabelMode": { "type": "string", "enum": ["text","emoji","both"], "description": "How edge relationship labels are displayed" },
        "maxEmojiPerLabel": { "type": "integer", "minimum": 0, "default": 3 }
      }
    },
    "assets": { "type": "array", "items": { "type": "string" }, "description": "Extra asset files to include (paths relative to bundle root)" },
    "networkOptions": {
      "type": "object",
      "properties": {
        "initialLayout": { "type": "string" },
        "nodeSizeField": { "type": "string", "description": "Optional node numeric field used for sizing" },
        "nodeColorField": { "type": "string" },
        "edgeColorField": { "type": "string" },
        "showNodeEmoji": { "type": "boolean" },
        "labelModes": { "type": "object", "properties": { "node": { "type": "string", "enum": ["name","emoji","both"] }, "edge": { "type": "string", "enum": ["text","emoji","both"] } } }
      }
    },
    "geoOptions": {
      "type": "object",
      "properties": {
        "mapStyle": { "type": "string", "description": "Map style or basemap identifier (MapLibre/Leaflet)" },
        "initialZoom": { "type": "number" },
        "showGeoNodes": { "type": "boolean" },
        "midpointLabels": { "type": "object", "properties": { "show": { "type": "boolean" }, "mode": { "type": "string", "enum": ["text","emoji","both"] }, "jitter": { "type": "number" }, "offset": { "type": "number" } } },
        "chevrons": { "type": "object", "properties": { "show": { "type": "boolean" }, "style": { "type": "string" } } },
        "usePixelPlacement": { "type": "boolean", "description": "If true, use pixel-space placement for midpoint labels (project/unproject)" }
      }
    }
  }
}
